(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{371:function(e,t,r){"use strict";r.r(t);var n,o,c,m,d,f,h,l,v,S,T,x=r(155),w=(r(51),r(42),r(90),r(65),r(11)),k=r(17),E=r(315),_=r(63),A=(r(297),r(232),r(598),r(196)),R={gameInstance:function(e,t,r,n){return Object(w.a)(regeneratorRuntime.mark((function e(){var t,o,c,m,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.metamask,o=t.ethAccount,c=t.netId,m=_.a["netId".concat(c)].gameContract,e.next=4,n["metamask/web3"]();case 4:return d=e.sent,e.abrupt("return",new d.eth.Contract(E,m,{from:o}));case 6:case"end":return e.stop()}}),e)})))}},I={SET_GAME_ADDRESS:function(e,address){e.gameAddress=address},SET_POOL_SIZE:function(e,t){e.poolSize=t},SET_FEE:function(e,t){e.fee=t},SET_RECORDS:function(e,t){e.records=t},SET_ADDRESS_URL:function(e,t){e.addressUrl=t},SET_TX_URL:function(e,t){e.txUrl=t},SET_TXS:function(e,t){var r=Object.keys(t)[0];e.txs[r]=t[r]},SET_MINING_STATUS:function(e,t){e.miningStatus=t},SET_SEAL_STATUS:function(e,t){e.sealStatus=t}},y={initBaseParams:(T=Object(w.a)(regeneratorRuntime.mark((function e(t){var r,n,o,c,m,d,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.state,r=t.getters,n=t.dispatch,o=t.commit,c=t.rootState,e.next=3,r.gameInstance();case 3:m=e.sent,o("SET_GAME_ADDRESS",m._address),d=c.metamask.netId,f=_.a["netId".concat(d)].explorerUrl,o("SET_TX_URL",f.tx),o("SET_ADDRESS_URL",f.address),n("getPoolSize"),n("getRecords"),n("getMiniDeposit");case 12:case"end":return e.stop()}}),e)}))),function(e){return T.apply(this,arguments)}),getMiniDeposit:(S=Object(w.a)(regeneratorRuntime.mark((function e(t){var r,n,o,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.rootState,n=t.commit,o=t.dispatch,c=t.getters,t.rootGetters,t.state,e.abrupt("return",new Promise((function(e,t){var m=function(){var d=Object(w.a)(regeneratorRuntime.mark((function d(f){var h,l,v,S,data,T,x;return regeneratorRuntime.wrap((function(d){for(;;)switch(d.prev=d.next){case 0:return h=f.retryAttempt,l=void 0===h?1:h,l++,d.prev=2,v=r.metamask.ethAccount,d.next=6,c.gameInstance();case 6:return S=d.sent,data=S.methods.minDeposit().encodeABI(),T={method:"eth_call",params:[{from:v,to:S._address,data:data},"latest"],from:v},d.next=11,o("metamask/sendAsync",T,{root:!0});case 11:x=d.sent,x=Object(k.hexToNumberString)(x),console.log("minDeposit",x),n("SET_FEE",x),e(x),d.next=21;break;case 18:d.prev=18,d.t0=d.catch(2),l>=5?t(d.t0):m({retryAttempt:l});case 21:case"end":return d.stop()}}),d,null,[[2,18]])})));return function(e){return d.apply(this,arguments)}}();m({})})));case 3:case"end":return e.stop()}}),e)}))),function(e){return S.apply(this,arguments)}),getTotalRecords:(v=Object(w.a)(regeneratorRuntime.mark((function e(t){var r,n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.rootState,t.commit,n=t.dispatch,o=t.getters,t.rootGetters,t.state,e.abrupt("return",new Promise((function(e,t){var c=function(){var m=Object(w.a)(regeneratorRuntime.mark((function m(d){var f,h,l,v,data,S,T;return regeneratorRuntime.wrap((function(m){for(;;)switch(m.prev=m.next){case 0:return f=d.retryAttempt,h=void 0===f?1:f,h++,m.prev=2,l=r.metamask.ethAccount,m.next=6,o.gameInstance();case 6:return v=m.sent,data=v.methods.recordNum(l).encodeABI(),S={method:"eth_call",params:[{from:l,to:v._address,data:data},"latest"],from:l},m.next=11,n("metamask/sendAsync",S,{root:!0});case 11:T=m.sent,T=Object(k.hexToNumber)(T),e(T),m.next=19;break;case 16:m.prev=16,m.t0=m.catch(2),h>=5?t(m.t0):c({retryAttempt:h});case 19:case"end":return m.stop()}}),m,null,[[2,16]])})));return function(e){return m.apply(this,arguments)}}();c({})})));case 3:case"end":return e.stop()}}),e)}))),function(e){return v.apply(this,arguments)}),getRecords:(l=Object(w.a)(regeneratorRuntime.mark((function e(t){var r,n,o,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.rootState,n=t.commit,o=t.dispatch,c=t.getters,t.rootGetters,t.state,e.abrupt("return",new Promise((function(e,t){var m=function(){var d=Object(w.a)(regeneratorRuntime.mark((function d(f){var h,l,v,S,T,data,x,w,E,_,R;return regeneratorRuntime.wrap((function(d){for(;;)switch(d.prev=d.next){case 0:return h=f.retryAttempt,l=void 0===h?1:h,l++,d.prev=2,v=r.metamask.ethAccount,d.next=6,c.gameInstance();case 6:return S=d.sent,d.next=9,o("getTotalRecords");case 9:return T=d.sent,console.info("totalRecords",T),data=S.methods.getRecords(v,0,T).encodeABI(),x={method:"eth_call",params:[{from:v,to:S._address,data:data},"latest"],from:v},d.next=15,o("metamask/sendAsync",x,{root:!0});case 15:w=d.sent,E=A.decodeParameters([{components:[{name:"deposit",type:"uint256"},{name:"result",type:"uint256"},{name:"divisor",type:"uint256"},{name:"remainder",type:"uint256"},{name:"blockNum",type:"uint256"},{name:"finish",type:"bool"},{name:"prize",type:"uint256"}],name:"records",type:"tuple[]"}],w),_=E.records,console.info(_),R=[],_.forEach((function(e,i){var t=Object.assign({},e);t.depositH=Object(k.fromWei)(e.deposit),R.push(t)})),n("SET_RECORDS",R),e(_),d.next=27;break;case 24:d.prev=24,d.t0=d.catch(2),l>=5?t(d.t0):m({retryAttempt:l});case 27:case"end":return d.stop()}}),d,null,[[2,24]])})));return function(e){return d.apply(this,arguments)}}();m({})})));case 3:case"end":return e.stop()}}),e)}))),function(e){return l.apply(this,arguments)}),getPoolSize:(h=Object(w.a)(regeneratorRuntime.mark((function e(t){var r,n,o,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.rootState,n=t.commit,o=t.dispatch,c=t.getters,t.rootGetters,t.state,e.abrupt("return",new Promise((function(e,t){var m=function(){var d=Object(w.a)(regeneratorRuntime.mark((function d(f){var h,l,v,S,data,T,x;return regeneratorRuntime.wrap((function(d){for(;;)switch(d.prev=d.next){case 0:return h=f.retryAttempt,l=void 0===h?1:h,l++,d.prev=2,v=r.metamask.ethAccount,d.next=6,c.gameInstance();case 6:return S=d.sent,data=S.methods.avaliableSize().encodeABI(),T={method:"eth_call",params:[{from:v,to:S._address,data:data},"latest"],from:v},d.next=11,o("metamask/sendAsync",T,{root:!0});case 11:x=d.sent,x=Object(k.hexToNumberString)(x),n("SET_POOL_SIZE",x),console.log("pool size",x),e(x),d.next=21;break;case 18:d.prev=18,d.t0=d.catch(2),l>=5?t(d.t0):m({retryAttempt:l});case 21:case"end":return d.stop()}}),d,null,[[2,18]])})));return function(e){return d.apply(this,arguments)}}();m({})})));case 3:case"end":return e.stop()}}),e)}))),function(e){return h.apply(this,arguments)}),mining:(f=Object(w.a)(regeneratorRuntime.mark((function e(t){var r,n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.state,t.getters,t.rootState,t.rootGetters,r=t.dispatch,n=t.commit,e.next=3,r("_mining");case 3:if(null==(o=e.sent)||null==o){e.next=13;break}return console.info("txHash",o),n("SET_TXS",{txHash:0}),n("SET_MINING_STATUS",0),r("checkMiningTransactionStatus",{txHash:o}),e.abrupt("return",!0);case 13:return e.abrupt("return",!1);case 14:case"end":return e.stop()}}),e)}))),function(e){return f.apply(this,arguments)}),seal:(d=Object(w.a)(regeneratorRuntime.mark((function e(t){var r,n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.state,t.getters,t.rootState,t.rootGetters,r=t.dispatch,n=t.commit,e.next=3,r("_seal");case 3:if(null==(o=e.sent)||null==o){e.next=13;break}return console.info("txHash",o),n("SET_TXS",{txHash:0}),n("SET_SEAL_STATUS",0),r("checkSealTransactionStatus",{txHash:o}),e.abrupt("return",!0);case 13:return e.abrupt("return",!1);case 14:case"end":return e.stop()}}),e)}))),function(e){return d.apply(this,arguments)}),_mining:(m=Object(w.a)(regeneratorRuntime.mark((function e(t){var r,n,o,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.state,n=t.getters,o=t.rootState,t.rootGetters,c=t.dispatch,t.commit,e.abrupt("return",new Promise((function(e,t){!function(){var m=Object(w.a)(regeneratorRuntime.mark((function m(d){var f,h,l,data,v,S;return regeneratorRuntime.wrap((function(m){for(;;)switch(m.prev=m.next){case 0:return Object(x.a)(d),m.prev=1,o.metamask.gasPrice.fast,f=o.metamask.ethAccount,m.next=6,n.gameInstance();case 6:return h=m.sent,l=h._address,data=h.methods.mining(r.divisor,r.remainder).encodeABI(),v={method:"eth_sendTransaction",params:[{from:f,to:l,gas:Object(k.numberToHex)(1e6),value:Object(k.toHex)(r.fee),data:data}],from:f},m.next=12,c("metamask/sendAsync",v,{root:!0});case 12:S=m.sent,e(S),m.next=19;break;case 16:m.prev=16,m.t0=m.catch(1),t(m.t0);case 19:case"end":return m.stop()}}),m,null,[[1,16]])})));return function(e){return m.apply(this,arguments)}}()({})})));case 2:case"end":return e.stop()}}),e)}))),function(e){return m.apply(this,arguments)}),checkMiningTransactionStatus:(c=Object(w.a)(regeneratorRuntime.mark((function e(t,r){var n,o,c,m,d,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.state,t.getters,t.rootGetters,t.rootState,n=t.dispatch,o=t.commit,c=r.txHash,m=10,e.prev=3,e.next=6,n("metamask/getTransactionReceipt",{txHash:c},{root:!0});case 6:null!=(d=e.sent)?(f=d.status,o("SET_MINING_STATUS",f="0x1"==f||1==f?1:-2),o("SET_TXS",{txHash:f})):setTimeout((function(){n("checkMiningTransactionStatus",{txHash:c})}),1e3*m),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(3),console.info("checking error",e.t0),setTimeout((function(){n("checkMiningTransactionStatus",{txHash:c})}),1e3*m);case 14:case"end":return e.stop()}}),e,null,[[3,10]])}))),function(e,t){return c.apply(this,arguments)}),checkSealTransactionStatus:(o=Object(w.a)(regeneratorRuntime.mark((function e(t,r){var n,o,c,m,d,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.state,t.getters,t.rootGetters,t.rootState,n=t.dispatch,o=t.commit,c=r.txHash,m=10,e.prev=3,e.next=6,n("metamask/getTransactionReceipt",{txHash:c},{root:!0});case 6:null!=(d=e.sent)?(f=d.status,o("SET_SEAL_STATUS",f="0x1"==f||1==f?1:-2),o("SET_TXS",{txHash:f})):setTimeout((function(){n("checkSealTransactionStatus",{txHash:c})}),1e3*m),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(3),console.info("checking error",e.t0),setTimeout((function(){n("checkSealTransactionStatus",{txHash:c})}),1e3*m);case 14:case"end":return e.stop()}}),e,null,[[3,10]])}))),function(e,t){return o.apply(this,arguments)}),_seal:(n=Object(w.a)(regeneratorRuntime.mark((function e(t){var r,n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.state,r=t.getters,n=t.rootState,t.rootGetters,o=t.dispatch,t.commit,e.abrupt("return",new Promise((function(e,t){!function(){var c=Object(w.a)(regeneratorRuntime.mark((function c(){var m,d,f,data,h,l;return regeneratorRuntime.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return c.prev=0,m=n.metamask.ethAccount,c.next=4,r.gameInstance();case 4:return d=c.sent,f=d._address,data=d.methods.seal().encodeABI(),h={method:"eth_sendTransaction",params:[{from:m,to:f,gas:Object(k.numberToHex)(1e6),value:Object(k.toHex)(0),data:data}],from:m},c.next=10,o("metamask/sendAsync",h,{root:!0});case 10:l=c.sent,e(l),c.next=17;break;case 14:c.prev=14,c.t0=c.catch(0),t(c.t0);case 17:case"end":return c.stop()}}),c,null,[[0,14]])})));return function(){return c.apply(this,arguments)}}()({})})));case 2:case"end":return e.stop()}}),e)}))),function(e){return n.apply(this,arguments)})};t.default={namespaced:!0,state:function(){return{gameAddress:"",poolSize:0,fee:5e18,addressUrl:"",txUrl:"",divisor:3,remainder:1,txs:{},sealStatus:-1,miningStatus:-1,records:[]}},getters:R,mutations:I,actions:y}},614:function(e,t,r){"use strict";r.r(t);r(42);var n,o=r(155),c=(r(615),r(65),r(11)),m=r(318),d=r.n(m),f=r(17),h=r(63),l=(r(297),r(319)),v=function(e){var t=e.newAccount;(0,e.commit)("IDENTIFY",Object(f.toChecksumAddress)(t[0])),window.location.reload()},S={netId:function(e){return e.netId},networkName:function(e){return h.a["netId".concat(e.netId)].networkName},currency:function(e){return h.a["netId".concat(e.netId)]?h.a["netId".concat(e.netId)].currencyName:"ETH"},networkConfig:function(e){return h.a["netId".concat(e.netId)]},getEthereumProvider:function(e){return Object(c.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",window.ethereum);case 1:case"end":return e.stop()}}),e)})))},web3:function(e,t){return Object(c.a)(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getEthereumProvider();case 2:return r=e.sent,e.abrupt("return",Object.freeze(new d.a(r)));case 4:case"end":return e.stop()}}),e)})))}},T={IDENTIFY:function(e,t){e.ethAccount=t},SET_NET_ID:function(e,t){t=parseInt(t,10),e.netId=t},SET_WALLET_STATE:function(e,t){e.walletState=t},SET_ADDRESS:function(e,t){var address=t.address,r=t.valid,n=void 0!==r&&r;e.address={value:address,valid:n}},SET_INITIALIZED:function(e,t){e.initialized=t}},x={setAddress:function(e,t){e.dispatch;var r=e.commit,address=t.address;r("SET_ADDRESS",{address:address,valid:address.length>=42&&Object(l.a)(address)})},onNetworkChanged:function(e,t){(0,e.commit)("SET_NET_ID",t.netId)},onChainIdChanged:function(e,t){var r=e.commit,n=t.chainId;r("SET_NET_ID",Object(f.hexToNumber)(n))},askPermission:function(e,t){var r=e.commit,n=e.dispatch,m=e.getters;e.rootGetters,e.state;return Object(o.a)(t),new Promise(function(){var e=Object(c.a)(regeneratorRuntime.mark((function e(t,o){var c,d,h,l,S;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r("SET_INITIALIZED",!1),e.next=3,m.getEthereumProvider();case 3:return c=e.sent,e.prev=4,null==c&&(r("SET_WALLET_STATE",-1),alert("Please Install Metamask"),o(new Error("Please Install Metamask"))),d=[],e.prev=7,e.next=10,c.enable();case 10:d=e.sent,e.next=18;break;case 13:return e.prev=13,e.t0=e.catch(7),e.next=17,c.request({method:"eth_requestAccounts"});case 17:d=e.sent;case 18:return 0===d.length&&(r("SET_WALLET_STATE",-2),alert("Please Unlock Metamask"),o(new Error("lockedMetamask"))),r("SET_WALLET_STATE",1),h=Object(f.toChecksumAddress)(d[0]),r("IDENTIFY",h),n("setAddress",{address:h}),e.next=25,n("sendAsync",{method:"eth_chainId",params:[]});case 25:l=e.sent,S=Object(f.hexToNumber)(l),n("onNetworkChanged",{netId:S}),c.on&&(c.on("accountsChanged",(function(e){return v({dispatch:n,commit:r,newAccount:e})})),c.on("chainChanged",(function(e){return window.location.reload()})),c.on("networkChanged",(function(e){return n("onNetworkChanged",{netId:e})}))),r("SET_INITIALIZED",!0),n("game/initBaseParams",{},{root:!0}),t({netId:S,ethAccount:d[0]}),e.next=37;break;case 34:e.prev=34,e.t1=e.catch(4),o(e.t1);case 37:case"end":return e.stop()}}),e,null,[[4,34],[7,13]])})));return function(t,r){return e.apply(this,arguments)}}())},getTransactionReceipt:(n=Object(c.a)(regeneratorRuntime.mark((function e(t,r){var n,o,m;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.state,t.getters,t.rootGetters,t.rootState,o=t.dispatch,t.commit,m=r.txHash,e.abrupt("return",new Promise((function(e,t){var r=function(){var d=Object(c.a)(regeneratorRuntime.mark((function c(d){var f,h,l,v;return regeneratorRuntime.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return f=d.retryAttempt,h=void 0===f?1:f,h++,c.prev=2,l={from:n.ethAccount,method:"eth_getTransactionReceipt",params:[m]},c.next=6,o("metamask/sendAsync",l,{root:!0});case 6:v=c.sent,e(v),c.next=13;break;case 10:c.prev=10,c.t0=c.catch(2),h>=2?t(c.t0):r({retryAttempt:h});case 13:case"end":return c.stop()}}),c,null,[[2,10]])})));return function(e){return d.apply(this,arguments)}}();r({})})));case 4:case"end":return e.stop()}}),e)}))),function(e,t){return n.apply(this,arguments)}),sendAsync:function(e,t){e.state;var r=e.getters,n=(e.rootState,t.method),o=t.from,m=t.params;return new Promise(function(){var e=Object(c.a)(regeneratorRuntime.mark((function e(t,c){var d,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.getEthereumProvider();case 2:d=e.sent;try{f={id:520,method:n,params:m,jsonrpc:"2.0",from:o},d.request(f).then((function(e){t(e)})).catch((function(e){c(e)}))}catch(e){c(e)}case 4:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}())}};t.default={namespaced:!0,state:function(){return{ethAccount:null,netId:1,currency:"ETH",initialized:!1,address:{value:null,valid:!1},providerName:"",networkName:"",walletState:1,gasPrice:{fast:10,low:5,standard:5,instant:20}}},getters:S,mutations:T,actions:x}}},[[699,49,43,46,42,44,45,40,1,32,15,36,18,16,30,13,25,3,39,22,35,19,26,8,38,17,20,41,28,29,37,21,24,2,5,31,33,11,34,23,4,7,10,6,9,27,14]]]);